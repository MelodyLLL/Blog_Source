# å‰ç«¯åŸºå»ºå’Œæ„å»ºå·¥å…·

## è¯´è¯´æ€æ ·æ§åˆ¶ä¸‰æ–¹ä¾èµ–ç‰ˆæœ¬

æ§åˆ¶ä¸‰æ–¹ä¾èµ–ç‰ˆæœ¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š

1. **ä½¿ç”¨ `package.json` æ–‡ä»¶**ï¼š
  åœ¨ `package.json` æ–‡ä»¶ä¸­æŒ‡å®šä¾èµ–çš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥ä½¿ç”¨ç²¾ç¡®ç‰ˆæœ¬å·ï¼ˆå¦‚ `1.2.3`ï¼‰ã€èŒƒå›´ç‰ˆæœ¬å·ï¼ˆå¦‚ `^1.2.3` æˆ– `~1.2.3`ï¼‰ç­‰ã€‚

2. **ä½¿ç”¨ `npm shrinkwrap` æˆ– `yarn.lock` æ–‡ä»¶**ï¼š
  è¿™äº›æ–‡ä»¶ä¼šé”å®šå½“å‰å®‰è£…çš„ä¾èµ–ç‰ˆæœ¬ï¼Œç¡®ä¿åœ¨ä¸åŒç¯å¢ƒä¸­å®‰è£…çš„ä¾èµ–ç‰ˆæœ¬ä¸€è‡´ã€‚

3. **ä½¿ç”¨ `npm ci` å‘½ä»¤**ï¼š
  åœ¨ CI/CD ç¯å¢ƒä¸­ä½¿ç”¨ `npm ci` å‘½ä»¤å®‰è£…ä¾èµ–ï¼Œå®ƒä¼šæ ¹æ® `package-lock.json` æ–‡ä»¶å®‰è£…ä¾èµ–ï¼Œç¡®ä¿ç‰ˆæœ¬ä¸€è‡´ã€‚

4. **æ‰‹åŠ¨æ›´æ–°ä¾èµ–**ï¼š
  å®šæœŸæ£€æŸ¥å¹¶æ‰‹åŠ¨æ›´æ–°ä¾èµ–ç‰ˆæœ¬ï¼Œç¡®ä¿ä½¿ç”¨çš„ä¾èµ–æ˜¯æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ã€‚

5. **ä½¿ç”¨å·¥å…·**ï¼š
  ä½¿ç”¨ `npm-check-updates` ç­‰å·¥å…·è‡ªåŠ¨æ£€æŸ¥å’Œæ›´æ–°ä¾èµ–ç‰ˆæœ¬ã€‚

é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æ§åˆ¶ä¸‰æ–¹ä¾èµ–çš„ç‰ˆæœ¬ï¼Œç¡®ä¿é¡¹ç›®çš„ç¨³å®šæ€§å’Œä¸€è‡´æ€§ã€‚

## AMD å’Œ CMDï¼Ÿ

è¿™ä¸¤è€…éƒ½æ˜¯ JavaScript æ¨¡å—åŒ–è§„èŒƒï¼Œä½†åœ¨æ¨¡å—å®šä¹‰å’ŒåŠ è½½çš„æ—¶æœºä¸Šå­˜åœ¨ä¸€äº›åŒºåˆ«ã€‚

## webpack æ„å»ºæµç¨‹ï¼Ÿè¯´å®Œæ•´ä¸€äº›ã€‚

webpack æ„å»ºæµç¨‹ï¼š

åˆå§‹åŒ–ï¼š è¯»å–é…ç½®æ–‡ä»¶ï¼Œåˆå§‹åŒ–å‚æ•°ï¼ŒåŠ è½½æ’ä»¶ã€‚

ç¼–è¯‘ï¼š ç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ï¼Œæ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ã€‚

åŠ è½½æ¨¡å—ï¼š ä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œé€’å½’åœ°æ„å»ºæ•´ä¸ªä¾èµ–å…³ç³»å›¾ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½ä¼šè¢«è½¬æ¢æˆæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ã€‚

å¯»æ‰¾ loaderï¼š åœ¨åŠ è½½æ¨¡å—çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¯¹åº”çš„æ–‡ä»¶ç±»å‹æ—¶ï¼Œwebpack ä¼šè°ƒç”¨é…ç½®å¥½çš„ loader æ¥å¯¹æ–‡ä»¶è¿›è¡Œè½¬æ¢ã€‚

æ„å»ºæ¨¡å—ï¼š é€’å½’åœ°åˆ†ææ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œæ ¹æ®ä¾èµ–å…³ç³»ç»„è£…æˆä¸€ä¸ªä¸ªæ¨¡å—ã€‚

ç”Ÿæˆä»£ç ï¼š æ ¹æ®ç»„è£…å¥½çš„æ¨¡å—ï¼Œç”Ÿæˆæœ€ç»ˆçš„ä»£ç å—ï¼ˆchunkï¼‰ï¼Œä¸€ä¸ª chunk ç”±å¤šä¸ªæ¨¡å—ç»„æˆã€‚

è¾“å‡ºæ–‡ä»¶ï¼š å°†æœ€ç»ˆçš„ä»£ç å—å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿã€‚

## webpack çš„çƒ­æ›´æ–°æ€ä¹ˆåšåˆ°çš„ï¼Ÿ

webpack çš„çƒ­æ›´æ–°ï¼š

Webpack çš„çƒ­æ›´æ–°ï¼ˆHot Module Replacementï¼ŒHMRï¼‰æ˜¯ä¸€ç§åœ¨åº”ç”¨è¿è¡Œè¿‡ç¨‹ä¸­æ›¿æ¢ã€æ·»åŠ æˆ–åˆ é™¤æ¨¡å—çš„èƒ½åŠ›ã€‚å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š

åœ¨åº”ç”¨ä»£ç ä¸­æ·»åŠ  HMR ä»£ç ï¼š é€šè¿‡ webpack æä¾›çš„ APIï¼Œåœ¨åº”ç”¨ä»£ç ä¸­åµŒå…¥å¯¹æ¨¡å—çš„ç›‘å¬å’Œæ›´æ–°å¤„ç†é€»è¾‘ã€‚

å¼€å¯ webpack çš„ HMR åŠŸèƒ½ï¼š åœ¨ webpack é…ç½®æ–‡ä»¶ä¸­é…ç½® hot: trueï¼Œå‘Šè¯‰ webpack å¯ç”¨ HMRã€‚

æœåŠ¡å™¨æ”¯æŒï¼š åœ¨å¼€å‘æœåŠ¡å™¨ä¸Šå¯ç”¨ HMR æ”¯æŒï¼Œè¿™å¯ä»¥é€šè¿‡ webpack-dev-server æ¥å®ç°ã€‚

å®¢æˆ·ç«¯æ”¯æŒï¼š åœ¨æµè§ˆå™¨ä¸­é€šè¿‡ WebSocket ç­‰æŠ€æœ¯ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œå½“æ¨¡å—å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒæœåŠ¡å™¨é€šè¿‡è¿æ¥é€šçŸ¥å®¢æˆ·ç«¯æ›´æ–°ã€‚

## webpack ä¸­è‡ªå®šä¹‰ loader

è‡ªå®šä¹‰ loader æ˜¯é€šè¿‡ç¼–å†™ Node.js æ¨¡å—æ¥å®ç°çš„ï¼Œè¿™ä¸ªæ¨¡å—éœ€è¦å¯¼å‡ºä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šåœ¨æ–‡ä»¶è½¬æ¢è¿‡ç¨‹ä¸­è¢«è°ƒç”¨ï¼Œå¹¶ä¸”æ¥æ”¶æ–‡ä»¶å†…å®¹ä½œä¸ºå‚æ•°ã€‚è‡ªå®šä¹‰ loader çš„ä¸»è¦å·¥ä½œæ˜¯å°†è¾“å…¥çš„æ–‡ä»¶å†…å®¹è¿›è¡Œè½¬æ¢ï¼Œç„¶åè¿”å›æ–°çš„å†…å®¹ã€‚

åœ¨ webpack é…ç½®ä¸­ï¼Œé€šè¿‡ module.rules é…ç½®é¡¹æ¥æŒ‡å®š loader

## babel æ˜¯ä»€ä¹ˆï¼Ÿ

> [Babel æ˜¯ä»€ä¹ˆï¼Ÿ Â· Babel ä¸­æ–‡æ–‡æ¡£ | Babel ä¸­æ–‡ç½‘](https://www.babeljs.cn/docs/)

## å†™è¿‡çš„ webpack æ’ä»¶ã€loaderï¼Ÿ

ç±»ä¼¼ eslint æ’ä»¶ï¼Œé›ªç¢§å›¾ loader, ç›‘æ§ loader

## rollup å¸¸è§é…ç½®ã€æ’ä»¶

Rollup æ˜¯ä¸€ä¸ª JavaScript æ¨¡å—æ‰“åŒ…å™¨ï¼Œå®ƒä¸“æ³¨äºå°†å°å—ä»£ç ç¼–è¯‘æˆæ›´å¤§ã€æ›´å¤æ‚çš„ä»£ç å—ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„ Rollup é…ç½®å’Œæ’ä»¶ï¼š

### å¸¸è§é…ç½®

- `input`ï¼šæŒ‡å®šå…¥å£æ–‡ä»¶çš„è·¯å¾„ã€‚
- `output`ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„é…ç½®ï¼ŒåŒ…æ‹¬æ–‡ä»¶è·¯å¾„ã€æ ¼å¼ç­‰ã€‚
- `plugins`ï¼šé…ç½®ä½¿ç”¨çš„æ’ä»¶ï¼Œä¾‹å¦‚å¤„ç† CSSã€å‹ç¼©ä»£ç ç­‰ã€‚

### å¸¸è§æ’ä»¶

- `rollup-plugin-babel`ï¼šç”¨äºå°† ES6+ ä»£ç è½¬æ¢ä¸ºå…¼å®¹çš„ JavaScript ä»£ç ã€‚
- `rollup-plugin-commonjs`ï¼šå°† CommonJS æ¨¡å—è½¬æ¢ä¸º ES6 æ¨¡å—ã€‚
- `rollup-plugin-node-resolve`ï¼šè§£æç¬¬ä¸‰æ–¹æ¨¡å—çš„è·¯å¾„ã€‚
- `rollup-plugin-terser`ï¼šå‹ç¼© JavaScript ä»£ç ã€‚
- `rollup-plugin-postcss`ï¼šå¤„ç† CSS æ–‡ä»¶ã€‚
- `rollup-plugin-sass`ï¼šå¤„ç† Sass æ–‡ä»¶ã€‚
- `rollup-plugin-json`ï¼šå¤„ç† JSON æ–‡ä»¶ã€‚

è¿™äº›æ˜¯ä¸€äº›å¸¸è§çš„ Rollup é…ç½®å’Œæ’ä»¶ï¼ŒğŸ‘‡æ˜¯webpackçš„é…ç½®æ–‡æ¡£ã€‚

> [é…ç½® | webpack ä¸­æ–‡æ–‡æ¡£](https://www.webpackjs.com/configuration/)

